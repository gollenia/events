!function(){"use strict";jQuery(document).ready((function(i){let n=!1;if(i("#start-time").each((function(e,t){i(t).addClass("em-time-input em-time-start").next("#end-time").addClass("em-time-input em-time-end").parent().addClass("em-time-range")})),i(".events-table").on("click",".em-event-delete",(function(){if(!confirm("Are you sure you want to delete?"))return!1;window.location.href=this.href})),i("#event-form #event-image-delete, #location-form #location-image-delete").on("click",(function(){let e=i(this);e.is(":checked")?e.closest(".event-form-image, .location-form-image").find("#event-image-img, #location-image-img").hide():e.closest(".event-form-image, .location-form-image").find("#event-image-img, #location-image-img").show()})),i("#em-tickets-form").length>0){i("#event-rsvp").on("click",(function(e){this.checked?i("#event-rsvp-options").fadeIn():0==confirm(EM.disable_bookings_warning)?e.preventDefault():i("#event-rsvp-options").hide()})),i("input#event-rsvp").is(":checked")?i("div#rsvp-data").fadeIn():i("div#rsvp-data").hide();let e=function(){i("#em-tickets-form table tbody tr.em-tickets-row").show(),i("#em-tickets-form table tbody tr.em-tickets-row-form").hide()};i("#em-recurrence-checkbox").length>0?i("#em-recurrence-checkbox").on("change",(function(){i("#em-recurrence-checkbox").is(":checked")?(i("#em-tickets-form .ticket-dates-from-recurring, #em-tickets-form .ticket-dates-to-recurring, #event-rsvp-options .em-booking-date-recurring").show(),i("#em-tickets-form .ticket-dates-from-normal, #em-tickets-form .ticket-dates-to-normal, #event-rsvp-options .em-booking-date-normal, #em-tickets-form .hidden").hide()):(i("#em-tickets-form .ticket-dates-from-normal, #em-tickets-form .ticket-dates-to-normal, #event-rsvp-options .em-booking-date-normal").show(),i("#em-tickets-form .ticket-dates-from-recurring, #em-tickets-form .ticket-dates-to-recurring, #event-rsvp-options .em-booking-date-recurring, #em-tickets-form .hidden").hide())})).trigger("change"):i("#em-form-recurrence").length>0?(i("#em-tickets-form .ticket-dates-from-recurring, #em-tickets-form .ticket-dates-to-recurring, #event-rsvp-options .em-booking-date-recurring").show(),i("#em-tickets-form .ticket-dates-from-normal, #em-tickets-form .ticket-dates-to-normal, #event-rsvp-options .em-booking-date-normal, #em-tickets-form .hidden").hide()):i("#em-tickets-form .ticket-dates-from-recurring, #em-tickets-form .ticket-dates-to-recurring, #event-rsvp-options .em-booking-date-recurring, #em-tickets-form .hidden").hide(),i("#em-tickets-add").on("click",(function(n){n.preventDefault(),e();let o=i("#em-tickets-form table tbody"),a=o.length+1,r=o.first(".em-ticket-template").clone(!0).attr("id","em-ticket-"+a).removeClass("em-ticket-template").addClass("em-ticket").appendTo(i("#em-tickets-form table"));r.find("*[name]").each((function(e,t){(t=i(t)).attr("name",t.attr("name").replace("em_tickets[0]","em_tickets["+a+"]"))})),r.show().find(".ticket-actions-edit").trigger("click"),r.find(".em-date-input-loc").datepicker("destroy").removeAttr("id"),r.find(".em-time-input").off().each((function(e,t){"object"==typeof this.em_timepickerObj&&this.em_timepicker("remove")})),em_setup_datepicker(r),em_setup_timepicker(r),i("html, body").animate({scrollTop:r.offset().top-30}),t()})),i(document).on("click",".ticket-actions-edit",(function(t){t.preventDefault(),e();let n=i(this).closest("tbody");return n.find("tr.em-tickets-row").hide(),n.find("tr.em-tickets-row-form").fadeIn(),!1})),i(document).on("click",".ticket-actions-edited",(function(e){e.preventDefault();let t=i(this).closest("tbody"),n=t.attr("id").replace("em-ticket-","");return t.find(".em-tickets-row").fadeIn(),t.find(".em-tickets-row-form").hide(),t.find("*[name]").each((function(e,o){if("ticket_start_pub"==(o=i(o)).attr("name"))t.find("span.ticket_start").text(o.val());else if("ticket_end_pub"==o.attr("name"))t.find("span.ticket_end").text(o.val());else if(o.attr("name")=="em_tickets["+n+"][ticket_type]")"members"==o.find(":selected").val()&&t.find("span.ticket_name").prepend("* ");else if(o.attr("name")=="em_tickets["+n+"][ticket_start_recurring_days]"){let e="before"==t.find("select.ticket-dates-from-recurring-when").val()?"-"+o.val():o.val();""!=o.val()?(t.find("span.ticket_start_recurring_days").text(e),t.find("span.ticket_start_recurring_days_text, span.ticket_start_time").removeClass("hidden").show()):(t.find("span.ticket_start_recurring_days").text(" - "),t.find("span.ticket_start_recurring_days_text, span.ticket_start_time").removeClass("hidden").hide())}else if(o.attr("name")=="em_tickets["+n+"][ticket_end_recurring_days]"){let e="before"==t.find("select.ticket-dates-to-recurring-when").val()?"-"+o.val():o.val();""!=o.val()?(t.find("span.ticket_end_recurring_days").text(e),t.find("span.ticket_end_recurring_days_text, span.ticket_end_time").removeClass("hidden").show()):(t.find("span.ticket_end_recurring_days").text(" - "),t.find("span.ticket_end_recurring_days_text, span.ticket_end_time").removeClass("hidden").hide())}else{let e=o.attr("name").replace("em_tickets["+n+"][","").replace("]","").replace("[]","");t.find(".em-tickets-row ."+e).text(o.val())}})),i(document).triggerHandler("em_maps_tickets_edit",[t,n,!0]),i("html, body").animate({scrollTop:t.parent().offset().top-30}),!1})),i(document).on("change",".em-ticket-form select.ticket_type",(function(e){let t=i(this);"members"==t.find("option:selected").val()?t.closest(".em-ticket-form").find(".ticket-roles").fadeIn():t.closest(".em-ticket-form").find(".ticket-roles").hide()})),i(document).on("click",".em-ticket-form .ticket-options-advanced",(function(e){e.preventDefault();let t=i(this);t.hasClass("show")?(t.closest(".em-ticket-form").find(".em-ticket-form-advanced").fadeIn(),t.find(".show,.show-advanced").hide(),t.find(".hide,.hide-advanced").show()):(t.closest(".em-ticket-form").find(".em-ticket-form-advanced").hide(),t.find(".show,.show-advanced").show(),t.find(".hide,.hide-advanced").hide()),t.toggleClass("show")})),i(".em-ticket-form").each((function(){let e=!1,t=i(this);t.find('.em-ticket-form-advanced input[type="text"]').each((function(){""!=this.value&&(e=!0)})),t.find('.em-ticket-form-advanced input[type="checkbox"]:checked').length>0&&(e=!0),t.find(".em-ticket-form-advanced option:selected").each((function(){""!=this.value&&(e=!0)})),e&&t.find(".ticket-options-advanced").trigger("click")})),i(document).on("click",".ticket-actions-delete",(function(e){e.preventDefault();let n=i(this),o=n.closest("tbody");return o.find("input.ticket_id").val()>0?(n.text("Deleting..."),i.getJSON(i(this).attr("href"),{em_ajax_action:"delete_ticket",id:o.find("input.ticket_id").val()},(function(e){e.result?o.remove():(n.text("Delete"),alert(e.error))}))):o.remove(),t(),!1})),i("#em-tickets-form.em-tickets-sortable table").sortable({items:"> tbody",placeholder:"em-ticket-sortable-placeholder",handle:".ticket-status",helper:function(e,t){let n=i(t).clone().addClass("em-ticket-sortable-helper"),o=n.find(".em-tickets-row td").length;return n.children().remove(),n.append('<tr class="em-tickets-row"><td colspan="'+o+'" style="text-align:left; padding-left:15px;"><span class="dashicons dashicons-tickets-alt"></span></td></tr>'),n}});let t=function(){let e=i("#em-tickets-form table tbody.em-ticket");if(1==e.length)return e.find(".ticket-status").addClass("single"),void i("#em-tickets-form.em-tickets-sortable table").sortable("option","disabled",!0);e.find(".ticket-status").removeClass("single"),i("#em-tickets-form.em-tickets-sortable table").sortable("option","disabled",!1)};t()}if(i("#em-bookings-table").length>0){document.addEventListener("click",(function(e){if(!e.target.matches("#em-bookings-table .tablenav-pages a"))return;e.preventDefault(),e.stopImmediatePropagation();let t=i(e.target),n=t.parents("#em-bookings-table form.bookings-filter"),o=t.attr("href").match(/#[0-9]+/);if(null!=o&&o.length>0){let e=o[0].replace("#","");n.find("input[name=pno]").val(e)}else n.find("input[name=pno]").val(1);return t.parents("#em-bookings-table").find(".table-wrap").first().append('<div id="em-loading" />'),i.post(EM.ajaxurl,n.serializeArray(),(function(e){let n=t.parents("#em-bookings-table").first();n.replaceWith(e),i("#em-bookings-table-export input[name=scope]").val(n.find("select[name=scope]").val()),i("#em-bookings-table-export input[name=status]").val(n.find("select[name=status]").val()),jQuery(document).triggerHandler("em_bookings_filtered",[e,n,t])})),!1}));let t={modal:!0,autoOpen:!1,minWidth:500,height:"auto",buttons:[{text:EM.bookings_settings_save,click:function(e){e.preventDefault(),e.bubbles=!1;let t=i("#em-bookings-table form.bookings-filter [name=cols]").val(""),n=i("form#em-bookings-table-settings-form input.em-bookings-col-item");i.each(n,(function(e,i){1==i.value&&(""!=t.val()?t.val(t.val()+","+i.name):t.val(i.name))})),i("#em-bookings-table-settings").trigger("submitted"),i("#em-bookings-table form.bookings-filter").trigger("submit"),i(this).dialog("close")}}]},o={modal:!0,autoOpen:!1,minWidth:700,height:"auto",buttons:[{text:EM.bookings_export_save,click:function(e){i(this).children("form").trigger("submit"),i(this).dialog("close")}}]};if(i("#em-bookings-table-settings").length>0){i("#em-bookings-table-settings").dialog(t),i(document).on("click","#em-bookings-table-settings-trigger",(function(e){e.preventDefault(),i("#em-bookings-table-settings").dialog("open")})),i("#em-bookings-table-export").dialog(o),i(document).on("click","#em-bookings-table-export-trigger",(function(e){e.preventDefault(),i("#em-bookings-table-export").dialog("open")}));let e=function(){i("#em-bookings-table-export-form input[name=show_tickets]").is(":checked")?(i("#em-bookings-table-export-form .em-bookings-col-item-ticket").show(),i("#em-bookings-table-export-form #em-bookings-export-cols-active .em-bookings-col-item-ticket input").val(1)):i("#em-bookings-table-export-form .em-bookings-col-item-ticket").hide().find("input").val(0)};i("#em-bookings-table form select").each((function(e,t){i(t).on("change",(function(e){let t=i(this),n=i("#em-bookings-table-export-form input[name="+t.attr("name")+"]"),o=t.find("option:selected");n.val(o.val())}))})),e(),i("#em-bookings-table-export-form input[name=show_tickets]").on("click",e),i(".em-bookings-cols-sortable").sortable({connectWith:".em-bookings-cols-sortable",update:function(e,t){t.item.parents("ul#em-bookings-cols-active, ul#em-bookings-export-cols-active").length>0?t.item.addClass("ui-state-highlight").removeClass("ui-state-default").children("input").val(1):t.item.addClass("ui-state-default").removeClass("ui-state-highlight").children("input").val(0)}}).disableSelection(),n=!0}i(document).on("click","#post-query-submit",(function(e){let t=i(e.target).closest("form");e.preventDefault(),t.parents("#em-bookings-table").find(".table-wrap").first().append('<div id="em-loading" />'),i.post(EM.ajaxurl,t.serializeArray(),(function(e){let n=t.parents("#em-bookings-table").first();n.replaceWith(e),i("#em-bookings-table-export input[name=scope]").val(n.find("select[name=scope]").val()),i("#em-bookings-table-export input[name=status]").val(n.find("select[name=status]").val()),jQuery(document).triggerHandler("em_bookings_filtered",[e,n,t])}))})),i(document).on("click",".em-bookings-approve,.em-bookings-reject,.em-bookings-unapprove,.em-bookings-delete",(function(){let t=i(this);if(t.hasClass("em-bookings-delete")&&!confirm(EM.booking_delete))return!1;let n=e(t.attr("href")),o=t.parents("td").first();return o.html(EM.txt_loading),o.load(n),!1}))}function o(){i(".interval-desc").hide();let e="-plural";1!=i("input#recurrence-interval").val()&&""!=i("input#recurrence-interval").val()||(e="-singular");let t="span#interval-"+i("select#recurrence-frequency").val()+e;i(t).show()}function a(){i("p.alternate-selector").hide(),i("p#"+i("select#recurrence-frequency").val()+"-selector").show()}function r(){i("input#event-recurrence").is(":checked")?(i("#event_recurrence_pattern").fadeIn(),i("#event-date-explanation").hide(),i("#recurrence-dates-explanation").show(),i("h3#recurrence-dates-title").show(),i("h3#event-date-title").hide()):(i("#event_recurrence_pattern").hide(),i("#recurrence-dates-explanation").hide(),i("#event-date-explanation").show(),i("h3#recurrence-dates-title").hide(),i("h3#event-date-title").show())}if(i(document).on("click","a.em-booking-button",(function(e){e.preventDefault();let t=i(this);if(t.text()!=EM.bb_booked&&i(this).text()!=EM.bb_booking){t.text(EM.bb_booking);let e=t.attr("id").split("_");i.ajax({url:EM.ajaxurl,dataType:"jsonp",data:{event_id:e[1],_wpnonce:e[2],action:"booking_add_one"},success:function(e,n,o,a){e.result?t.text(EM.bb_booked):t.text(EM.bb_error),""!=e.message&&alert(e.message),i(document).triggerHandler("em_booking_button_response",[e,t])},error:function(){t.text(EM.bb_error)}})}return!1})),i(document).on("click","a.em-cancel-button",(function(e){e.preventDefault();let t=i(this);if(t.text()!=EM.bb_cancelled&&t.text()!=EM.bb_canceling){t.text(EM.bb_canceling);let e=t.attr("id").split("_");i.ajax({url:EM.ajaxurl,dataType:"jsonp",data:{booking_id:e[1],_wpnonce:e[2],action:"booking_cancel"},success:function(e,i,n,o){e.result?t.text(EM.bb_cancelled):t.text(EM.bb_cancel_error)},error:function(){t.text(EM.bb_cancel_error)}})}return!1})),i("#recurrence-dates-explanation").hide(),i("#date-to-submit").hide(),i("#end-date-to-submit").hide(),i("#localised-date").show(),i("#localised-end-date").show(),i("#em-wrapper input.select-all").on("change",(function(){i(this).is(":checked")?(i("input.row-selector").prop("checked",!0),i("input.select-all").prop("checked",!0)):(i("input.row-selector").prop("checked",!1),i("input.select-all").prop("checked",!1))})),o(),a(),r(),i("input#event-recurrence").on("change",r),i("input#recurrence-interval").on("keyup",o),i("select#recurrence-frequency").on("change",o),i("select#recurrence-frequency").on("change",a),i(".em-location-types .em-location-types-select").on("change",(function(){let e=i(this);if(0==e.val())i(".em-location-type").hide();else{let t=e.find("option:selected").data("display-class");i(".em-location-type").hide(),i(".em-location-type."+t).show(),"em-location-type-place"!=t&&jQuery("#em-location-reset a").trigger("click")}""!==e.data("active")&&e.val()!==e.data("active")?(i(".em-location-type-delete-active-alert").hide(),i(".em-location-type-delete-active-alert").show()):i(".em-location-type-delete-active-alert").hide()})).trigger("change"),jQuery("div.em-location-data input#location-name").length>0&&(jQuery("div.em-location-data input#location-name").autocomplete({source:EM.locationajaxurl,minLength:2,focus:function(e,t){return jQuery("input#location-id").val(t.item.value),!1},select:function(e,t){return jQuery("input#location-id").val(t.item.id).trigger("change"),jQuery("input#location-name").val(t.item.value),jQuery("input#location-address").val(t.item.address),jQuery("input#location-town").val(t.item.town),jQuery("input#location-state").val(t.item.state),jQuery("input#location-region").val(t.item.region),jQuery("input#location-postcode").val(t.item.postcode),jQuery("input#location-latitude").val(t.item.latitude),jQuery("input#location-longitude").val(t.item.longitude),""==t.item.country?jQuery("select#location-country option:selected").removeAttr("selected"):jQuery('select#location-country option[value="'+t.item.country+'"]').attr("selected","selected"),jQuery("div.em-location-data input").css("background-color","#ccc").prop("readonly",!0),jQuery("div.em-location-data select").css("background-color","#ccc").css("color","#666666").prop("disabled",!0),jQuery("#em-location-reset").show(),jQuery("#em-location-search-tip").hide(),jQuery(document).triggerHandler("em_locations_autocomplete_selected",[e,t]),!1}}).data("ui-autocomplete")._renderItem=function(e,i){let n="<a>"+t(i.label)+'<br><span style="font-size:11px"><em>'+t(i.address)+", "+t(i.town)+"</em></span></a>";return jQuery("<li></li>").data("item.autocomplete",i).append(n).appendTo(e)},jQuery("#em-location-reset a").on("click",(function(){return jQuery("div.em-location-data input").val("").prop("readonly",!1),jQuery("div.em-location-data select").prop("disabled",!1),jQuery("div.em-location-data option:selected").removeAttr("selected"),jQuery("input#location-id").val(""),jQuery("#em-location-reset").hide(),jQuery("#em-location-search-tip").show(),jQuery("#em-map").hide(),jQuery("#em-map-404").show(),"undefined"!=typeof marker&&(marker.setPosition(new google.maps.LatLng(0,0)),infoWindow.close(),marker.setDraggable(!0)),!1})),"0"!=jQuery("input#location-id").val()&&""!=jQuery("input#location-id").val()&&(jQuery("div.em-location-data input").prop("readonly",!0),jQuery("div.em-location-data select").prop("disabled",!0),jQuery("#em-location-reset").show(),jQuery("#em-location-search-tip").hide())),window.moment){let e=function(e,t){return(t=(t=(t=(t=t.replace(/##T/g,Intl.DateTimeFormat().resolvedOptions().timeZone)).replace(/#T/g,"GMT"+e.format("Z"))).replace(/###t/g,-60*e.utcOffset())).replace(/##t/g,e.isDST())).replace(/#t/g,e.daysInMonth())};i(".em-date-momentjs").each((function(){let t=i(this),n=moment.unix(t.data("date-start"));e(n,n.format(t.data("date-format")));if(t.data("date-start")!==t.data("date-end")){let i=moment.unix(t.data("date-end"));e(n,i.format(t.data("date-format")));t.data("date-separator")}t.text(date_string)}));let t=function(e,t){let i=new Date(1e3*e),n=i.getMinutes();if(24==t){let e=i.getHours();return e=e<10?"0"+e:e,n=n<10?"0"+n:n,e+":"+n}{let e=i.getHours()%12,t=e>=12?"PM":"AM";return 0===e&&(e=12),n=n<10?"0"+n:n,e+":"+n+" "+t}};i(".em-time-localjs").each((function(){let e=i(this),n=t(e.data("time"),e.data("time-format"));e.data("time-end")&&(n=n+(e.data("time-separator")?e.data("time-separator"):" - ")+t(e.data("time-end"),e.data("time-format"))),e.text(n)}))}jQuery(document).triggerHandler("em_javascript_loaded")}));let e=function(e){return-1!=e.search("em_ajax=0")?e=e.replace("em_ajax=0","em_ajax=1"):-1!=e.search(/\?/)?e+="&em_ajax=1":e+="?em_ajax=1",e};function t(e){return"string"!=typeof e?"":e.replace(/</gi,"&lt;").replace(/>/gi,"&gt;")}document.addEventListener("DOMContentLoaded",(function(){let e=document.querySelectorAll(".em-nav-item");if(0==e.length)return;if(1==e.length)return document.querySelector(".em-nav-side")?.classList.add("hidden"),void document.querySelector(".em-nav-content")?.classList.remove("hidden");e.forEach((t=>{t.addEventListener("click",(i=>{e.forEach((e=>{e.classList.remove("active")})),document.querySelectorAll(".em-nav-content")?.forEach((e=>{e.classList.add("hidden")})),i.target.classList.add("active"),document.querySelector(t.getAttribute("rel"))?.classList.remove("hidden")}))}));let t=document.querySelectorAll(".em-accordion-item");t.forEach((e=>{e.addEventListener("click",(i=>{t.forEach((e=>{e.classList.remove("active")})),document.querySelectorAll(".em-accordion-content")?.forEach((e=>{e.classList.add("hidden")})),i.target.classList.add("active"),document.getElementById(e.getAttribute("rel"))?.classList.remove("hidden")}))})),document.querySelectorAll(".em-subgroup-email").forEach((e=>{let t=e.querySelector(".em-cet-status"),i=e.querySelector(".em-mail-vals"),n=e.querySelector(".em-mail-status-indicator");t.addEventListener("change",(e=>{n?.setAttribute("data-status",e.target.value),1!=e.target.value?i.classList.add("hidden"):i.classList.remove("hidden")}))})),document.getElementById("booking-modal-close")?.addEventListener("click",(e=>{document.getElementById("booking-modal").style.display="none"})),document.getElementById("email-modal-close")?.addEventListener("click",(e=>{document.getElementById("email-modal").style.display="none"}))}),!1),document.addEventListener("DOMContentLoaded",(()=>{document.body.addEventListener("click",(e=>{if(e.target.classList.contains("em-bookings-approve-offline")&&!confirm(EM.offline_confirm))return e.stopPropagation(),e.stopImmediatePropagation(),e.preventDefault(),!1})),document.body.addEventListener("click",(t=>{if(t.target.classList.contains("em-transaction-delete")){const i=t.target;if(!confirm(EM.transaction_delete))return!1;const n=e(i.attr("href"));let o=i.parents("td").first();return o.html(EM.txt_loading),o.load(n),!1}}))}))}();